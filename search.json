[{"title":"备用地址","url":"/2025/10/26/备用地址/","content":"\n备用地址：https://blognf-github-io.vercel.app/\n\n\n"},{"title":"国内虚拟机ubuntu中安装Docker和Docker Compose","url":"/2025/10/25/国内虚拟机ubuntu中安装Docker和Docker Compose/","content":"\n###### 在此之前如果未接触过服务器命令，请查看vim的修改和保存命令，本文基于vim进行修改文件\n\n### 一、🔧 安装 Docker CE\n\n###### 1、执行命令**更新系统并安装必要工具**\n\n```bash\nsudo apt update\nsudo apt upgrade -y\n```\n\n###### 2、 如果报错（没有则略过）：\n\n```bash\nroot@ygc:/# sudo apt update\nsudo apt upgrade -y\nHit:1 https://mirrors.aliyun.com/docker-ce/linux/ubuntu jammy InRelease\nHit:2 https://download.docker.com/linux/ubuntu jammy InRelease                                        \nErr:3 http://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy InRelease                    \n  403  Forbidden [IP: 101.6.15.130 80]\nErr:4 http://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-updates InRelease\n  403  Forbidden [IP: 101.6.15.130 80]\nErr:5 http://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-backports InRelease\n  403  Forbidden [IP: 101.6.15.130 80]\nErr:6 http://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-security InRelease\n  403  Forbidden [IP: 101.6.15.130 80]\nReading package lists... Done\nW: https://mirrors.aliyun.com/docker-ce/linux/ubuntu/dists/jammy/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.\nN: See apt-secure(8) manpage for repository creation and user configuration details.\nN: Updating from such a repository can't be done securely, and is therefore disabled by default.\nE: The repository 'http://cn.archive.ubuntu.com/ubuntu jammy InRelease' is no longer signed.\nE: Failed to fetch http://cn.archive.ubuntu.com/ubuntu/dists/jammy/InRelease  403  Forbidden [IP: 101.6.15.130 80]\nN: See apt-secure(8) manpage for repository creation and user configuration details.\nN: Updating from such a repository can't be done securely, and is therefore disabled by default.\nE: The repository 'http://cn.archive.ubuntu.com/ubuntu jammy-updates InRelease' is no longer signed.\nE: Failed to fetch http://cn.archive.ubuntu.com/ubuntu/dists/jammy-updates/InRelease  403  Forbidden [IP: 101.6.15.130 80]\nE: Failed to fetch http://cn.archive.ubuntu.com/ubuntu/dists/jammy-backports/InRelease  403  Forbidden [IP: 101.6.15.130 80]\nE: The repository 'http://cn.archive.ubuntu.com/ubuntu jammy-backports InRelease' is no longer signed.\nN: Updating from such a repository can't be done securely, and is therefore disabled by default.\nN: See apt-secure(8) manpage for repository creation and user configuration details.\nE: Failed to fetch http://cn.archive.ubuntu.com/ubuntu/dists/jammy-security/InRelease  403  Forbidden [IP: 101.6.15.130 80]\nE: The repository 'http://cn.archive.ubuntu.com/ubuntu jammy-security InRelease' is no longer signed.\nN: Updating from such a repository can't be done securely, and is therefore disabled by default.\nN: See apt-secure(8) manpage for repository creation and user configuration details.\nReading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\nCalculating upgrade... Done\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\n```\n\n###### 3、 报错后执行换源\n\n```ssh\n# 备份当前损坏的文件\nsudo mv /etc/apt/sources.list /etc/apt/sources.list.bak\n\n# 重新生成标准源文件（使用阿里云镜像）\nsudo tee /etc/apt/sources.list > /dev/null << 'EOF'\ndeb http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse\nEOF\n```\n\n###### 4 、安装必要的软件包\n\n```bash\nsudo apt install -y apt-transport-https ca-certificates curl software-properties-common\n```\n\n###### 5、 添加阿里云（docker）GPG密钥管理\n\n```bash\nsudo curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -\n\n#curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg #docker的官方GPG密钥\n```\n\n###### 6、 进入到/etc/apt/sources.list.d目录，添加软件源\n\n```bash\ncd /etc/apt/sources.list.d\n```\n\n###### 7、 添加软件源：在/etc/apt/sources.list.d目录下的docker.list文件中添加阿里云的镜像下载源（使用官网的）\n\n```bash\nsudo echo \"deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable\" > docker.list\n#sudo echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] #https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | sudo tee #/etc/apt/sources.list.d/docker.list > /dev/null\n```\n\n###### 8、更新软件源\n\n```bash\nsudo apt update\n```\n\n###### 9、docker ce安装\n\n```bash\nsudo apt install docker-ce docker-ce-cli containerd.io docker-compose-plugin -y\n```\n\n###### 10、启动Docker并设置开机自启\n\n```bash\nsudo systemctl start docker\nsudo systemctl enable docker\n```\n\n###### 11、验证安装\n\n```bash\nsudo docker run hello-world\n```\n\n###### 12、如果出错\n\n```bash\nsudo systemctl enable docker\nSynchronizing state of docker.service with SysV service script with /lib/systemd/systemd-sysv-install.\nExecuting: /lib/systemd/systemd-sysv-install enable docker\n```\n\n###### 13、报错请换源，通常在 /etc/docker/daemon.json\n\n```bash\n{\n    \"registry-mirrors\": [\n            \"https://registry.docker-cn.com\",\n             \"https://docker.m.daocloud.io\",           \n             \"https://dockerpull.org\",            \n             \"https://dockerpull.com\"\n    ]\n}\n```\n\n### 二、📦 安装 Docker Compose\n\n###### 1、**下载Docker Compose二进制文件**   直接从GitHub发布页下载稳定版本的Docker Compose。鉴于国内网络，如果直接下载较慢，可以多尝试几次，或者考虑使用第三方镜像源。\n\n```bash\nsudo curl -L \"https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose  #此版本可以直接下载，用更新的版本推荐使用国内镜像\n```\n\n请注意，版本号（此例中为2.40.2）可能会更新。你可以查看Docker Compose的[GitHub发布页](https://github.com/docker/compose/releases)以获取最新的稳定版本号\n\n\n\n### 三、🚀 配置国内镜像加速器(需要自行获取加速器地址)\n\n为了进一步提升后续拉取Docker镜像的速度，强烈建议你配置一个国内镜像加速器。\n\n###### 1、修改Docker守护进程配置，编辑Docker的配置文件（通常是`/etc/docker/daemon.json`）。如果文件不存在，可以新建一个。\n\n```bash\nsudo vim /etc/docker/daemon.json\n```\n\n###### 2、例如，使用中科大镜像，配置文件内容如下：\n\n```bash\n{\n  \"registry-mirrors\": [\"https://docker.mirrors.ustc.edu.cn\"]\n}\n```\n\n###### **3、重启Docker服务**  ，让配置生效：\n\n```bash\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n```\n\n###### 4、**授予执行权限**   下载完成后，需要给二进制文件添加可执行权限\n\n```bash\nsudo chmod +x /usr/local/bin/docker-compose\n```\n\n###### **5、验证安装** ，检查Docker Compose是否安装成功：\n\n```bash\ndocker-compose --version\n```\n"}]